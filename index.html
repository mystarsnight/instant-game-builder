<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Instant Game Builder</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;font-family:Arial;background:#b3d9ff}
#app{max-width:1000px;margin:auto;background:#fff;padding:12px;border-radius:12px}
textarea,button,input{width:100%;padding:10px;margin:6px 0;border-radius:8px;font-size:14px}
button{background:#4caf50;color:#fff;border:none;cursor:pointer}
button.small{width:auto;padding:6px 10px;font-size:12px}
#game{height:360px;background:#e3f2fd;border-radius:10px;position:relative;overflow:hidden}
.obj{width:56px;height:56px;border-radius:12px;position:absolute;display:flex;align-items:center;justify-content:center;cursor:pointer}
.enemy{filter:hue-rotate(180deg)}
.row{display:flex;gap:6px;background:#eee;padding:6px;border-radius:6px;margin:4px 0;flex-wrap:wrap}
#notice{background:#222;color:#fff;padding:8px;border-radius:6px;display:none}
#overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center;z-index:999}
#modal{background:#fff;padding:20px;border-radius:12px;max-width:360px;text-align:center}
#mobileAI{background:#e8f5e9;padding:12px;border-radius:10px;margin-bottom:10px}
</style>
</head>
<body>

<div id="overlay">
  <div id="modal">
    <h3>AI Game Builder</h3>
    <p>Type ANY game idea.<br>No rules needed.</p>
    <button onclick="dismiss()">OK</button>
  </div>
</div>

<div id="app">
<h2>Instant Game Builder</h2>

<div id="mobileAI">
  <b>ğŸ¤– AI Game Generator</b>
  <input id="aiInput" placeholder="Example: enemy game with coins, 1k win">
  <button onclick="aiGame()">Generate Game</button>
</div>

<div id="notice"></div>

<textarea id="rules" rows="7"></textarea>

<button onclick="buildGame()">â–¶ Play</button>
<button onclick="saveGame()">ğŸ’¾ Save</button>
<button onclick="copyLink()">ğŸ”— Copy Link</button>
<button onclick="exportRoblox()">ğŸ® Export Roblox</button>

<div id="game"></div>
<div id="stats"></div>

<h3>My Games</h3>
<div id="library"></div>
</div>

<script>
const rulesBox=rules=document.getElementById("rules")
const game=document.getElementById("game")
const stats=document.getElementById("stats")
const lib=document.getElementById("library")
const notice=document.getElementById("notice")
const aiInput=document.getElementById("aiInput")

function show(t){notice.innerText=t;notice.style.display="block";setTimeout(()=>notice.style.display="none",2000)}
if(localStorage.getItem("seen")!=="1"){}
function dismiss(){document.getElementById("overlay").style.display="none";localStorage.setItem("seen","1")}

let objs={},enemies=[],rulesArr=[]
let score=0,health=100,win=10,keys={}

function emoji(name){
  const m={player:"ğŸ™‚",coin:"ğŸª™",gem:"ğŸ’",enemy:"ğŸ‘¾"}
  return m[name]||"â­"
}

function img(e){
  return `data:image/svg+xml;base64,${btoa(`<svg xmlns='http://www.w3.org/2000/svg' width='64' height='64'><rect rx='12' width='100%' height='100%' fill='#fff'/><text x='50%' y='55%' font-size='40' text-anchor='middle'>${e}</text></svg>`)}`
}

function buildGame(){
  game.innerHTML=""
  objs={};enemies=[]
  score=0;health=100;win=10
  rulesArr=rulesBox.value.split("\n")

  rulesArr.forEach(r=>{
    if(r.startsWith("spawn "))spawn(r.split(" ")[1])
    if(r==="enemy")spawnEnemy()
    if(r.startsWith("win"))win=parseNum(r)
  })
  update()
}

function spawn(name){
  if(objs[name])return
  const d=document.createElement("div")
  d.className="obj"
  d.style.background=`url(${img(emoji(name))}) center/contain no-repeat`
  d.style.left=Math.random()*80+"%"
  d.style.top=Math.random()*80+"%"
  d.onclick=()=>{score++;update()}
  game.appendChild(d);objs[name]=d
}

function spawnEnemy(){
  const e=document.createElement("div")
  e.className="obj enemy"
  e.style.background=`url(${img("ğŸ‘¾")}) center/contain no-repeat`
  e.style.left=Math.random()*80+"%"
  e.style.top=Math.random()*80+"%"
  game.appendChild(e);enemies.push(e)
}

setInterval(()=>{
  if(objs.player){
    enemies.forEach(en=>{
      let ex=en.offsetLeft,ey=en.offsetTop
      let px=objs.player.offsetLeft,py=objs.player.offsetTop
      en.style.left=ex+(px>ex?2:-2)+"px"
      en.style.top=ey+(py>ey?2:-2)+"px"
      if(Math.abs(px-ex)<32&&Math.abs(py-ey)<32)health--
    })
  }
  update()
},100)

function update(){
  if(health<=0){stats.innerText="GAME OVER";return}
  if(score>=win){stats.innerText="YOU WIN";return}
  stats.innerText=`Score ${score}/${win} | Health ${health}`
}

function parseNum(t){
  let m=t.match(/(\d+)(k)?/)
  return m?parseInt(m[1])*(m[2]?1000:1):10
}

function aiGame(){
  let t=aiInput.value.toLowerCase()
  let out=["spawn player"]
  if(t.includes("enemy"))out.push("enemy")
  if(t.includes("coin"))out.push("spawn coin")
  out.push("win "+(parseNum(t)||10))
  rulesBox.value=out.join("\n")
  buildGame()
  show("Game created by AI")
}

function saveGame(){
  let n=prompt("Name game")
  if(!n)return
  let g=JSON.parse(localStorage.getItem("games")||"[]")
  g.push({id:Date.now(),name:n,rules:rulesBox.value})
  localStorage.setItem("games",JSON.stringify(g))
  loadGames()
}

function loadGames(){
  lib.innerHTML=""
  JSON.parse(localStorage.getItem("games")||"[]").forEach(g=>{
    let d=document.createElement("div")
    d.className="row"
    d.innerHTML=`<b>${g.name}</b>`
    d.append(btn("Play",()=>{rulesBox.value=g.rules;buildGame()}))
    d.append(btn("Rename",()=>{g.name=prompt(\"New name\",g.name);saveAll()}))
    d.append(btn("Delete",()=>{saveAll(x=>x.id!==g.id)}))
    lib.appendChild(d)
  })
}
function saveAll(f){
  let g=JSON.parse(localStorage.getItem("games")||"[]")
  localStorage.setItem("games",JSON.stringify(f?g.filter(f):g))
  loadGames()
}
function btn(t,f){let b=document.createElement("button");b.className="small";b.innerText=t;b.onclick=f;return b}
loadGames()

function copyLink(){
  navigator.clipboard.writeText(location.href)
  show("Link copied")
}

function exportRoblox(){
  const lua=`print('Instant Game Builder Export')`
  const a=document.createElement("a")
  a.href=URL.createObjectURL(new Blob([lua],{type:"text/plain"}))
  a.download="InstantGame.lua"
  a.click()
}
</script>
</body>
</html>
